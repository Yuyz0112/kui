{
  "application": {
    "version": "sunmao/v1",
    "kind": "Application",
    "metadata": {
      "name": "kui"
    },
    "spec": {
      "components": [
        {
          "id": "root",
          "type": "kui/v1/root",
          "properties": {},
          "traits": []
        },
        {
          "id": "main",
          "type": "core/v1/stack",
          "properties": {
            "spacing": 12,
            "direction": "vertical",
            "align": "auto",
            "wrap": "",
            "justify": ""
          },
          "traits": [
            {
              "type": "core/v1/slot",
              "properties": {
                "container": {
                  "id": "root",
                  "slot": "root"
                }
              }
            },
            {
              "type": "core/v1/style",
              "properties": {
                "styles": [
                  {
                    "styleSlot": "content",
                    "style": "width: 100%;\npadding: 20px;"
                  }
                ]
              }
            }
          ]
        },
        {
          "id": "toolbar",
          "type": "core/v1/stack",
          "properties": {
            "spacing": 12,
            "direction": "horizontal",
            "align": "auto",
            "wrap": "",
            "justify": "space-between"
          },
          "traits": [
            {
              "type": "core/v1/slot",
              "properties": {
                "container": {
                  "id": "main",
                  "slot": "content"
                }
              }
            },
            {
              "type": "core/v1/style",
              "properties": {
                "styles": [
                  {
                    "styleSlot": "content",
                    "style": "border-bottom: 1px solid rgba(211,218,235,.6);\npadding-bottom: 8px;\n"
                  }
                ]
              }
            }
          ]
        },
        {
          "id": "page_title",
          "type": "core/v1/text",
          "properties": {
            "value": {
              "raw": "K8s 集群",
              "format": "plain"
            }
          },
          "traits": [
            {
              "type": "core/v1/slot",
              "properties": {
                "container": {
                  "id": "toolbar",
                  "slot": "content"
                }
              }
            },
            {
              "type": "core/v1/style",
              "properties": {
                "styles": [
                  {
                    "styleSlot": "content",
                    "style": "font-size: 24px;\nline-height: 32px;\nfont-family: Inter;\nfont-style: normal;\nfont-weight: 700;"
                  }
                ]
              }
            }
          ]
        },
        {
          "id": "create_btn",
          "type": "kui/v1/button",
          "properties": {
            "type": "primary"
          },
          "traits": [
            {
              "type": "core/v1/slot",
              "properties": {
                "container": {
                  "id": "toolbar",
                  "slot": "content"
                }
              }
            },
            {
              "type": "core/v1/event",
              "properties": {
                "handlers": [
                  {
                    "type": "onClick",
                    "componentId": "show_modal",
                    "method": {
                      "name": "setValue",
                      "parameters": {
                        "key": "value",
                        "value": "true"
                      }
                    },
                    "disabled": false,
                    "wait": {
                      "type": "delay",
                      "time": 0
                    }
                  }
                ]
              }
            }
          ]
        },
        {
          "id": "create_text",
          "type": "core/v1/text",
          "properties": {
            "value": {
              "raw": "创建 K8s 集群",
              "format": "plain"
            }
          },
          "traits": [
            {
              "type": "core/v1/slot",
              "properties": {
                "container": {
                  "id": "create_btn",
                  "slot": "content"
                }
              }
            }
          ]
        },
        {
          "id": "create_modal",
          "type": "kui/v1/modal",
          "properties": {
            "type": "primary",
            "width": 800,
            "visible": "{{ show_modal.value }}",
            "maskClosable": true,
            "title": "创建 K8s 集群"
          },
          "traits": [
            {
              "type": "core/v1/slot",
              "properties": {
                "container": {
                  "id": "main",
                  "slot": "content"
                }
              }
            },
            {
              "type": "core/v1/event",
              "properties": {
                "handlers": [
                  {
                    "type": "onClose",
                    "componentId": "show_modal",
                    "method": {
                      "name": "setValue",
                      "parameters": {
                        "key": "value",
                        "value": "false"
                      }
                    },
                    "disabled": false,
                    "wait": {
                      "type": "delay",
                      "time": 0
                    }
                  }
                ]
              }
            }
          ]
        },
        {
          "id": "create_form_container",
          "type": "core/v1/stack",
          "properties": {
            "spacing": 12,
            "direction": "horizontal",
            "align": "auto",
            "wrap": "",
            "justify": ""
          },
          "traits": [
            {
              "type": "core/v1/slot",
              "properties": {
                "container": {
                  "id": "create_modal",
                  "slot": "content"
                }
              }
            },
            {
              "type": "core/v1/style",
              "properties": {
                "styles": [
                  {
                    "styleSlot": "content",
                    "style": "width: 650px;\nmargin: 0 auto;"
                  }
                ]
              }
            }
          ]
        },
        {
          "id": "create_form",
          "type": "kui/v1/unstructured_form",
          "properties": {
            "spec": "{{{\n  \"type\": \"object\",\n  \"properties\": {\n    \"cloudProvider\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"cloudtower\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"elfCluster\": {\n              \"title\": \"集群\",\n              \"type\": \"string\"\n            }\n          }\n        }\n      }\n    },\n    \"version\": {\n      \"title\": \"K8s 集群版本\",\n      \"type\": \"string\",\n      \"enum\": [\n        \"1.20.6\"\n      ],\n      \"default\": \"1.20.6\"\n    },\n    \"clusterNetwork\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"pods\": {\n          \"type\": \"object\",\n          \"required\": [\n            \"cidrBlocks\"\n          ],\n          \"properties\": {\n            \"cidrBlocks\": {\n              \"title\": \"Pod 网络\",\n              \"description\": \"The network ranges from which Pod networks are allocated.\",\n              \"type\": \"array\",\n              \"items\": {\n                \"title\": \"CIDR\",\n                \"type\": \"string\"\n              },\n              \"default\": [\"\"]\n            }\n          }\n        },\n        \"services\": {\n          \"type\": \"object\",\n          \"required\": [\n            \"cidrBlocks\"\n          ],\n          \"properties\": {\n            \"cidrBlocks\": {\n              \"title\": \"Service 网络\",\n              \"description\": \"The network ranges from which service VIPs are allocated.\",\n              \"type\": \"array\",\n              \"items\": {\n                \"title\": \"CIDR\",\n                \"type\": \"string\"\n              },\n              \"default\": [\"\"]\n            }\n          }\n        }\n      }\n    },\n    \"cni\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"name\": {\n          \"title\": \"CNI 名称\",\n          \"type\": \"string\",\n          \"enum\": [\n            \"calico\",\n            \"everoute\"\n          ],\n          \"default\": \"calico\"\n        },\n        \"version\": {\n          \"title\": \"CNI 版本\",\n          \"type\": \"string\"\n        }\n      }\n    },\n    \"controlPlaneEndpoint\": {\n      \"type\": \"object\",\n      \"required\": [\n        \"host\",\n        \"port\"\n      ],\n      \"properties\": {\n        \"host\": {\n          \"title\": \"VIP\",\n          \"type\": \"string\"\n        },\n        \"port\": {\n          \"title\": \"端口\",\n          \"type\": \"integer\",\n          \"format\": \"int32\",\n          \"default\": 6443\n        }\n      }\n    },\n    \"topology\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"controlPlane\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"nodeConfig\": {\n              \"type\": \"object\",\n              \"properties\": {\n                \"cloneMode\": {\n                  \"title\": \"克隆模式\",\n                  \"type\": \"string\",\n                  \"enum\": [\n                    \"FastClone\",\n                    \"FullClone\"\n                  ],\n                  \"default\": \"FastClone\"\n                },\n                \"cpuCores\": {\n                  \"title\": \"vCPU\",\n                  \"type\": \"integer\",\n                  \"format\": \"int32\",\n                  \"default\": 2\n                },\n                \"memoryMB\": {\n                  \"title\": \"内存（MiB）\",\n                  \"type\": \"integer\",\n                  \"format\": \"int32\",\n                  \"default\": 4096\n                },\n                \"diskSizeGB\": {\n                  \"title\": \"磁盘空间（GiB）\",\n                  \"type\": \"integer\",\n                  \"format\": \"int32\",\n                  \"default\": 40\n                },\n                \"network\": {\n                  \"type\": \"object\",\n                  \"required\": [\n                    \"devices\"\n                  ],\n                  \"properties\": {\n                    \"devices\": {\n                      \"title\": \"虚拟网卡\",\n                      \"type\": \"array\",\n                      \"items\": {\n                        \"type\": \"object\",\n                        \"properties\": {\n                          \"vlan\": {\n                            \"title\": \"虚拟网络\",\n                            \"type\": \"string\"\n                          },\n                          \"networkType\": {\n                            \"title\": \"网络类型\",\n                            \"type\": \"string\",\n                            \"enum\": [\n                              \"ipv4_dhcp\"\n                            ],\n                            \"default\": \"ipv4_dhcp\"\n                          }\n                        }\n                      }\n                    }\n                  }\n                },\n                \"vmTemplate\": {\n                  \"title\": \"虚拟机模版\",\n                  \"type\": \"string\"\n                }\n              }\n            },\n            \"replicas\": {\n              \"title\": \"管理节点数量\",\n              \"type\": \"integer\",\n              \"format\": \"int32\",\n              \"default\": 1\n            }\n          }\n        },\n        \"workers\": {\n          \"widgetOptions\": {\n            \"displayLabel\": false\n          },\n          \"type\": \"array\",\n          \"items\": {\n            \"title\": \"计算节点组\",\n            \"type\": \"object\",\n            \"properties\": {\n              \"nodeConfig\": {\n                \"type\": \"object\",\n                \"properties\": {\n                  \"cloneMode\": {\n                    \"title\": \"克隆模式\",\n                    \"type\": \"string\",\n                    \"enum\": [\n                      \"FastClone\",\n                      \"FullClone\"\n                    ],\n                    \"default\": \"FastClone\"\n                  },\n                  \"cpuCores\": {\n                    \"title\": \"vCPU\",\n                    \"type\": \"integer\",\n                    \"format\": \"int32\",\n                    \"default\": 4\n                  },\n                  \"memoryMB\": {\n                    \"title\": \"内存（MiB）\",\n                    \"type\": \"integer\",\n                    \"format\": \"int32\",\n                    \"default\": 8192\n                  },\n                  \"diskSizeGB\": {\n                    \"title\": \"磁盘空间（GiB）\",\n                    \"type\": \"integer\",\n                    \"format\": \"int32\",\n                    \"default\": 40\n                  },\n                  \"network\": {\n                    \"type\": \"object\",\n                    \"required\": [\n                      \"devices\"\n                    ],\n                    \"properties\": {\n                      \"devices\": {\n                        \"title\": \"虚拟网卡\",\n                        \"type\": \"array\",\n                        \"items\": {\n                          \"type\": \"object\",\n                          \"properties\": {\n                            \"vlan\": {\n                              \"title\": \"虚拟网络\",\n                              \"type\": \"string\"\n                            },\n                            \"networkType\": {\n                              \"title\": \"网络类型\",\n                              \"type\": \"string\",\n                              \"enum\": [\n                                \"ipv4_dhcp\"\n                              ],\n                              \"default\": \"ipv4_dhcp\"\n                            }\n                          }\n                        }\n                      }\n                    }\n                  },\n                  \"vmTemplate\": {\n                    \"title\": \"虚拟机模版\",\n                    \"type\": \"string\"\n                  }\n                }\n              },\n              \"replicas\": {\n                \"title\": \"计算节点数量\",\n                \"type\": \"integer\",\n                \"format\": \"int32\",\n                \"default\": 2\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}}}",
            "defaultValue": null
          },
          "traits": [
            {
              "type": "core/v1/slot",
              "properties": {
                "container": {
                  "id": "create_form_container",
                  "slot": "content"
                }
              }
            }
          ]
        },
        {
          "id": "create_sec_1",
          "type": "core/v1/text",
          "properties": {
            "value": {
              "raw": "基本信息",
              "format": "plain"
            }
          },
          "traits": [
            {
              "type": "core/v1/slot",
              "properties": {
                "container": {
                  "id": "create_form",
                  "slot": "beforeField"
                },
                "ifCondition": "{{ $slot.path === '.cloudProvider.cloudtower' }}"
              }
            },
            {
              "type": "core/v1/style",
              "properties": {
                "styles": [
                  {
                    "styleSlot": "content",
                    "style": "font-weight: 700;\ncolor: #2d3a56;\npadding-bottom: 6px;\nborder-bottom: 1px solid rgba(213, 219, 227, 0.6);\nmargin-bottom: 16px;\ndisplay: block;\nwidth: 100%;"
                  }
                ]
              }
            }
          ]
        },
        {
          "id": "create_sec_2",
          "type": "core/v1/text",
          "properties": {
            "value": {
              "raw": "容器网络插件",
              "format": "plain"
            }
          },
          "traits": [
            {
              "type": "core/v1/slot",
              "properties": {
                "container": {
                  "id": "create_form",
                  "slot": "beforeField"
                },
                "ifCondition": "{{ $slot.path === '.cni' }}"
              }
            },
            {
              "type": "core/v1/style",
              "properties": {
                "styles": [
                  {
                    "styleSlot": "content",
                    "style": "font-weight: 700;\ncolor: #2d3a56;\npadding-bottom: 6px;\nborder-bottom: 1px solid rgba(213, 219, 227, 0.6);\nmargin-bottom: 16px;\ndisplay: block;\nwidth: 100%;"
                  }
                ]
              }
            }
          ]
        },
        {
          "id": "create_sec_3",
          "type": "core/v1/text",
          "properties": {
            "value": {
              "raw": "API Server",
              "format": "plain"
            }
          },
          "traits": [
            {
              "type": "core/v1/slot",
              "properties": {
                "container": {
                  "id": "create_form",
                  "slot": "beforeField"
                },
                "ifCondition": "{{ $slot.path === '.controlPlaneEndpoint' }}"
              }
            },
            {
              "type": "core/v1/style",
              "properties": {
                "styles": [
                  {
                    "styleSlot": "content",
                    "style": "font-weight: 700;\ncolor: #2d3a56;\npadding-bottom: 6px;\nborder-bottom: 1px solid rgba(213, 219, 227, 0.6);\nmargin-bottom: 16px;\ndisplay: block;\nwidth: 100%;"
                  }
                ]
              }
            }
          ]
        },
        {
          "id": "create_sec_4",
          "type": "core/v1/text",
          "properties": {
            "value": {
              "raw": "管理节点配置",
              "format": "plain"
            }
          },
          "traits": [
            {
              "type": "core/v1/slot",
              "properties": {
                "container": {
                  "id": "create_form",
                  "slot": "beforeField"
                },
                "ifCondition": "{{ $slot.path === '.topology.controlPlane' }}"
              }
            },
            {
              "type": "core/v1/style",
              "properties": {
                "styles": [
                  {
                    "styleSlot": "content",
                    "style": "font-weight: 700;\ncolor: #2d3a56;\npadding-bottom: 6px;\nborder-bottom: 1px solid rgba(213, 219, 227, 0.6);\nmargin-bottom: 16px;\ndisplay: block;\nwidth: 100%;"
                  }
                ]
              }
            }
          ]
        },
        {
          "id": "create_sec_5",
          "type": "core/v1/text",
          "properties": {
            "value": {
              "raw": "计算节点配置",
              "format": "plain"
            }
          },
          "traits": [
            {
              "type": "core/v1/slot",
              "properties": {
                "container": {
                  "id": "create_form",
                  "slot": "beforeField"
                },
                "ifCondition": "{{ $slot.path === '.topology.workers' }}"
              }
            },
            {
              "type": "core/v1/style",
              "properties": {
                "styles": [
                  {
                    "styleSlot": "content",
                    "style": "font-weight: 700;\ncolor: #2d3a56;\npadding-bottom: 6px;\nborder-bottom: 1px solid rgba(213, 219, 227, 0.6);\nmargin-bottom: 16px;\ndisplay: block;\nwidth: 100%;"
                  }
                ]
              }
            }
          ]
        },
        {
          "id": "text22",
          "type": "core/v1/text",
          "properties": {
            "value": {
              "raw": "{{ $slot.path }}",
              "format": "plain"
            }
          },
          "traits": [
            {
              "type": "core/v1/slot",
              "properties": {
                "container": {
                  "id": "create_form",
                  "slot": "field"
                },
                "ifCondition": "{{ $slot.path === '.topology.controlPlane.nodeConfig.vmTemplate' }}"
              }
            }
          ]
        },
        {
          "id": "cancel_create_btn",
          "type": "kui/v1/button",
          "properties": {
            "type": "text"
          },
          "traits": [
            {
              "type": "core/v1/slot",
              "properties": {
                "container": {
                  "id": "create_modal",
                  "slot": "footer"
                }
              }
            },
            {
              "type": "core/v1/event",
              "properties": {
                "handlers": [
                  {
                    "type": "onClick",
                    "componentId": "show_modal",
                    "method": {
                      "name": "setValue",
                      "parameters": {
                        "key": "value",
                        "value": "false"
                      }
                    },
                    "disabled": false,
                    "wait": {
                      "type": "delay",
                      "time": 0
                    }
                  }
                ]
              }
            }
          ]
        },
        {
          "id": "cancel_text",
          "type": "core/v1/text",
          "properties": {
            "value": {
              "raw": "取消",
              "format": "plain"
            }
          },
          "traits": [
            {
              "type": "core/v1/slot",
              "properties": {
                "container": {
                  "id": "cancel_create_btn",
                  "slot": "content"
                }
              }
            }
          ]
        },
        {
          "id": "submit_create_btn",
          "type": "kui/v1/button",
          "properties": {
            "type": "primary"
          },
          "traits": [
            {
              "type": "core/v1/slot",
              "properties": {
                "container": {
                  "id": "create_modal",
                  "slot": "footer"
                }
              }
            }
          ]
        },
        {
          "id": "confirm_create_text",
          "type": "core/v1/text",
          "properties": {
            "value": {
              "raw": "创建",
              "format": "plain"
            }
          },
          "traits": [
            {
              "type": "core/v1/slot",
              "properties": {
                "container": {
                  "id": "submit_create_btn",
                  "slot": "content"
                }
              }
            }
          ]
        },
        {
          "id": "k8s_cluster_table",
          "type": "kui/v1/unstructured_table",
          "properties": {
            "kind": "Deployment",
            "apiBase": "/apis/kubesmart.smtx.io/v1alpha1/kubesmartclusters",
            "columns": [
              {
                "key": "name",
                "title": "Name",
                "dataIndex": "metadata.name",
                "width": 200
              },
              {
                "key": "namespace",
                "title": "Namespace",
                "dataIndex": "metadata.namespace",
                "width": 150
              },
              {
                "key": "age",
                "title": "Age",
                "dataIndex": "metadata.creationTimestamp",
                "width": 100
              },
              {
                "key": "phase",
                "title": "状态",
                "dataIndex": "status.phase",
                "width": 100
              },
              {
                "key": "vip",
                "title": "VIP",
                "dataIndex": "spec.controlPlaneEndpoint",
                "width": 150
              },
              {
                "key": "control-plane",
                "title": "管理节点数量",
                "dataIndex": "spec.topology.controlPlane.replicas",
                "width": 100
              },
              {
                "key": "worker",
                "title": "计算节点数量",
                "dataIndex": "spec.topology.workers.0.replicas",
                "width": 100
              }
            ],
            "namespace": "",
            "fieldSelector": ""
          },
          "traits": [
            {
              "type": "core/v1/slot",
              "properties": {
                "container": {
                  "id": "main",
                  "slot": "content"
                }
              }
            },
            {
              "type": "core/v1/style",
              "properties": {
                "styles": []
              }
            },
            {
              "type": "core/v1/event",
              "properties": {
                "handlers": [
                  {
                    "type": "onActive",
                    "componentId": "k8s_cluster_sidebar",
                    "method": {
                      "name": "setVisible",
                      "parameters": {
                        "visible": true
                      }
                    },
                    "disabled": false,
                    "wait": {
                      "type": "delay",
                      "time": 0
                    }
                  }
                ]
              }
            }
          ]
        },
        {
          "id": "vip_text",
          "type": "core/v1/text",
          "properties": {
            "value": {
              "raw": "{{ $slot.value.host }}",
              "format": "plain"
            }
          },
          "traits": [
            {
              "type": "core/v1/slot",
              "properties": {
                "container": {
                  "id": "k8s_cluster_table",
                  "slot": "cell"
                },
                "ifCondition": "{{ $slot.key === 'vip' }}"
              }
            }
          ]
        },
        {
          "id": "phase_text",
          "type": "core/v1/text",
          "properties": {
            "value": {
              "raw": "{{ $slot.value }}",
              "format": "plain"
            }
          },
          "traits": [
            {
              "type": "core/v1/slot",
              "properties": {
                "container": {
                  "id": "k8s_cluster_table",
                  "slot": "cell"
                },
                "ifCondition": "{{ $slot.key === 'phase' }}"
              }
            },
            {
              "type": "core/v1/style",
              "properties": {
                "styles": [
                  {
                    "styleSlot": "content",
                    "style": "color: {{\n  {\n    'Provisioned': '#25c764'\n  }[$slot.value] || '#ff9100' \n}};"
                  }
                ]
              }
            }
          ]
        },
        {
          "id": "k8s_cluster_sidebar",
          "type": "kui/v1/unstructured_sidebar",
          "properties": {
            "item": "{{ k8s_cluster_table.activeItem }}",
            "defaultVisible": false
          },
          "traits": [
            {
              "type": "core/v1/slot",
              "properties": {
                "container": {
                  "id": "main",
                  "slot": "content"
                }
              }
            },
            {
              "type": "core/v1/event",
              "properties": {
                "handlers": []
              }
            }
          ]
        },
        {
          "id": "show_modal",
          "type": "core/v1/dummy",
          "properties": {},
          "traits": [
            {
              "type": "core/v1/state",
              "properties": {
                "key": "value",
                "initialValue": "false"
              }
            }
          ]
        }
      ]
    }
  },
  "modules": []
}